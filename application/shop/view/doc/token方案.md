
## 签名校验方案v2


说明：

1. 为接口安全计，需要在接口中传入其他参数作为校验。最终服务端以客户端接口参数做校验得到sign，和客户端传来的sign做比较，一致则认为通过。
1. 每次登录成功后，会有userlogin_token保存在客户端，同时返回给手机端并长期保存。
1. 算sign的方案：  （+表示字符串合并）  
uid　＋　当前手机时间戳　＋　userlogin_token的前10位  +  C0W509，计算md5值，取前12位，转小写。  
1. 示例：  
uid：1  
当前时间戳：1476268879  
userlogin_token：25172f23816e8f235562a97428f3148a  
则 $sign = md5("1147626887925172f2381C0W509") ；  // 现在 sign = '2e0ee37a2c71b0b689f6563891f4a8fe'；  
继续 ，sign = '2e0ee37a2c71',把 前面12位 这个值给服务端，并确保小写。

客户端：

1. 请求中增加参数v，值为2。表示签名计算的版本。
1. 请求中增加参数sign，值需要客户端计算。
1. 请求中增加参数time，值为手机当时时间戳，需和计算公式里用的保持一致。
1. 请求中必须有uid，原来接口有，则不管，否则要加。
1. 发出请求时，先查手机数据存储中有无userlogin_sign，有可以，无则单独向服务器发送一个请求获得。


服务端：  

1. 判断是否有参数v，如无，则放过，为了兼容老的客户端代码。
2. 如有v，v必须为2，否则错误。
2. 如有v，计算sign，如和客户端传来的sign相等，则验证通过。
2. 如有v，加时间判断，如客户端时间戳，在当前服务端时间戳前后一小时之外，则无效。

哪些接口加：

1. 看文档 [《签名校验方案接口列表》](/shop/doc/index/name/%E7%AD%BE%E5%90%8D%E6%A0%A1%E9%AA%8C%E6%96%B9%E6%A1%88%E6%8E%A5%E5%8F%A3%E5%88%97%E8%A1%A8)
